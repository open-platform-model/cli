// Database component template with persistent storage.
package components

import (
	resources_workload "opmodel.dev/resources/workload@v0"
	resources_storage "opmodel.dev/resources/storage@v0"
)

// _db is a reusable database component template.
#db: {
	resources_workload.#Container
	resources_storage.#PersistentVolume

	spec: {
		container: {
			image: string
			ports: db: {
				targetPort: 5432
			}
			resources: {
				requests: {
					cpu:    "200m"
					memory: "512Mi"
				}
				limits: {
					cpu:    "1000m"
					memory: "2Gi"
				}
			}
			volumeMounts: [{
				name:      "data"
				mountPath: "/var/lib/postgresql/data"
			}]
		}
		storage: {
			name: "data"
			size: string | *"10Gi"
		}
	}
}
