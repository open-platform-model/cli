// Package main defines the {{.ModuleName}} module.
// This is a simple single-file module with inline components.
package main

import (
	"opmodel.dev/core@v0"
	resources_workload "opmodel.dev/resources/workload@v0"
	traits_workload "opmodel.dev/traits/workload@v0"
)

// Module definition
core.#Module

// Module metadata
metadata: {
	apiVersion:  "{{.ModulePath}}@v0"
	name:        "{{.ModuleNamePascal}}"
	version:     "{{.Version}}"
	description: string | *"A simple OPM module"
	defaultNamespace: "default"
}

// Components define the workloads for this module.
#components: {
	// Example: web server component
	app: {
		resources_workload.#Container
		traits_workload.#Replicas

		spec: {
			container: {
				image: #config.image
				ports: http: {
					targetPort: #config.port
				}
			}
			replicas: #config.replicas
		}
	}
}

// Configuration schema
#config: {
	// Container image to deploy
	image!: string

	// Number of replicas
	replicas?: int & >=1

	// Port to expose
	port?: int & >0 & <=65535
}
